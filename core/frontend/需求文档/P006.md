# 测试覆盖率追踪报告

## 概览与配比
- 总子需求数: 11 (针对 P006 模块)
- 当前规划统计（近似值）:
  - Unit: ≈2
  - Component: ≈6
  - Integration: ≈2
  - E2E: ≈1

## src/pages/P006/UserOrdersPage.jsx

### ✅ 单元测试 (Unit)
- 状态映射逻辑 (tests/frontend/pages/P006_Orders/unit/status_map.spec.ts)
- 验证后端状态码(0, 1, 2)正确转换为前端显示文本("未支付", "已支付", "已取消")
- 验证状态码对应的CSS类名映射逻辑(如0对应status-pending)
- 列表过滤逻辑 (tests/frontend/pages/P006_Orders/unit/filter_logic.spec.ts)
- 验证输入全部订单列表和过滤条件(如"未支付")后返回正确的子数组

### 🧩 组件测试 (Component)
- 初始加载与空状态 (tests/frontend/pages/P006_Orders/component/initial_state.spec.tsx)
- 验证组件挂载时显示Loading状态
- 验证API返回空数组时显示“暂无订单”的空状态提示
- 列表渲染完整性 (tests/frontend/pages/P006_Orders/component/list_render.spec.tsx)
- 验证Mock数据中的多个订单被正确渲染为列表项
- 验证每个订单项包含车次号、日期、起止站、总金额和当前状态
- 状态标签样式 (tests/frontend/pages/P006_Orders/component/status_style.spec.tsx)
- 验证“未支付”订单显示橙色标签，“已支付”显示绿色，“已取消”显示灰色
- 操作按钮逻辑 (tests/frontend/pages/P006_Orders/component/action_buttons.spec.tsx)
- 验证“未支付”订单显示“去支付”和“取消订单”按钮
- 验证“已支付”订单显示“退票”或“改签”按钮(如有)
- 验证“已取消”或“已完成”订单不显示操作按钮或显示“删除订单”
- 取消订单交互 (tests/frontend/pages/P006_Orders/component/cancel_interaction.spec.tsx)
- 验证点击“取消订单”按钮触发二次确认弹窗(window.confirm或Modal)
- 验证确认取消后调用取消处理函数
- Tab切换交互 (tests/frontend/pages/P006_Orders/component/tab_switch.spec.tsx)
- 验证点击“全部”、“未支付”、“已支付”等Tab后，当前Tab高亮且列表内容发生变化(前端过滤或重新请求)

### 🔗 集成测试 (Integration)
- 列表数据获取 (tests/frontend/pages/P006_Orders/integration/fetch_list.spec.tsx)
- 验证页面加载时自动调用获取订单列表API
- 验证API返回401(未登录)时重定向至登录页
- 订单操作联动 (tests/frontend/pages/P006_Orders/integration/order_actions.spec.tsx)
- 验证点击“去支付”跳转至/payment/:orderId
- 验证点击“取消订单”并确认后 -> 调用取消API -> API成功 -> 重新调用列表API刷新数据 -> 验证该订单状态变为“已取消”

### 🚀 E2E 测试 (Playwright)
- 订单管理流程 (tests/e2e/order_management.spec.ts)
- 登录 -> 进入我的订单页 -> 验证看到之前创建的订单 -> 筛选“未支付” -> 点击去支付 -> 验证跳转